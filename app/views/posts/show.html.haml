- content_for :head do
  %meta{property: 'og:title',content: "#{@post.title}"}
  %meta{property: 'og:url', content: "http://www.athappyplace.com/posts/#{@post.id}"}
  %meta{property: 'og:image', content: "#{@post.photo.url}"}
  %meta{property: 'og:description', content: "#{sanitize(truncate(@post.description, length: 300, escape: false), attributes: %w(href))}"}

= render 'contents'

.row
  .col-md-1
  .col-md-10
    %p.txtStyle.small_title.underline Other posts you may like:

.row
  - @suggested_posts.each_with_index do |p, index|
    .col-md-4.image-container.box-container.listing.suggestions{:class => "#{offset_for_class(index)}"}
      = link_to post_path(p.id) do
        = image_tag custom_url(p), class: 'image-medium'
      %br
      = link_to post_path(p.id) do
        %p.txtStyle.small_title= p.title
      = link_to "<p class='info'>Author: #{p.user.username}</p>".html_safe, posts_user_path(p.user)
%br
%br

.row
  .col-md-1
  .col-md-10
    %p.txtStyle.small_title Comments:

- @post.comments.includes(:user).each do |comment|
  .row
    .col-md-1
    .col-md-10.image-container.box-container
      .col-md-1
        = image_tag get_user_profile_picture(comment.user), class: 'profile-pic img-circle'
      .col-md-10.comment
        %p.comment-text.txtStyle.tiny-text= username_for_user(comment.user)
        %br
        %p.comment-text.txtStyle.small_title= comment.thought
    .col-md-1
%br

.row
  .col-md-1
  .col-md-10.image-container.box-container
    = simple_form_for(@post.comments.new, url: add_comment_post_path(@post)) do |c|
      .col-md-1
        = image_tag get_user_profile_picture(current_user), class: 'profile-pic img-circle'
      .col-md-10.comment
        %p.comment-text.txtStyle.tiny-text= username_for_user(current_user)
        %br
        = c.input :thought, as: :text, label: false
        = c.hidden_field :user_id, value: value_of_user_id(current_user)
        = link_to 'Add', '#', id: 'add_comment_link', class: 'btn'
    %br
  .col-md-1

:javascript
  var post_url = "#{@post.new_record? ? posts_path : post_path(@post)}";
  var post_method = "#{@post.new_record? ? 'POST' : 'PATCH'}";

  $('#add_comment_link').click(function(){
    $('#new_comment').submit()
  });

  stLight.options({ 
    publisher: "fdbea845-8135-4aa2-8e80-2b90c45e6728",
    doNotHash: false,
    doNotCopy: false,
    hashAddressBar: false
  });
  var postImageUrl = "#{@post.photo.url}"
  var options = {
    "publisher": "fdbea845-8135-4aa2-8e80-2b90c45e6728",
    "position": "right",
    "ad": { "visible": false, "openDelay": 5, "closeDelay": 0 },
    "chicklets": { "items": ["facebook", "twitter", "googleplus", "email", "sharethis"]},
    "chicklets_params": {
      "facebook": { "st_image": postImageUrl },
      "twitter": { "st_image": postImageUrl },
      "googleplus": { "st_image": postImageUrl },
      "email": { "st_image": postImageUrl },
      "sharethis": { "st_image": postImageUrl }
    }
  };
  var st_hover_widget = new sharethis.widgets.hoverbuttons(options);
